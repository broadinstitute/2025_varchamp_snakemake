## Should ONLY be run when located in 2.snakemake_pipeline/
from pathlib import Path
import sys

# Get the directory containing this Snakefile
SNAKEFILE_DIR = Path(workflow.snakefile).parent
# Go up two levels to get to 2.snakemake_pipeline/
PIPELINE_DIR = SNAKEFILE_DIR.parent.parent

# Add pipeline directory to Python path so modules can be imported
sys.path.insert(0, str(PIPELINE_DIR))

configfile: str(PIPELINE_DIR / "inputs/configs/2025_01_27_Batch_13.json")

include: str(PIPELINE_DIR / "rules/common.smk")
include: str(PIPELINE_DIR / "rules/preprocess.smk")
include: str(PIPELINE_DIR / "rules/analysis.smk")

BATCH = config["Metadata_Batch"]
PIPELINE = config["pipeline"]
inputs = config["input_dir"]
outputs = config["output_dir"]

rule all:
    input:
        f"{outputs}/classification_analyses/{BATCH}/{PIPELINE}/metrics.csv",
        f"{outputs}/classification_analyses/{BATCH}/{PIPELINE}/metrics_gfp_adj.csv"